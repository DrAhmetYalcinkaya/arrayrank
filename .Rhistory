} else {
c("array", "Name", "value")
}
# Check if the data contains the required columns
if (!all(required_columns %in% colnames(df))) {
stop(paste("Data must contain the following columns:", paste(required_columns, collapse = ", ")))
}
if (array_type == "chambered" || array_type == "segmented") {
long_result <- df[, .(Mvalue = mean(value, na.rm = TRUE)), by = .(array, Block, Name)]
wide_result <- long_result %>% pivot_wider(names_from = Name, values_from = Mvalue)
message("Data calculated/arranged for chambered/segmented arrays")
transposed_result <- as.data.frame(t(wide_result))
array <- paste(sep="", "Arr",sapply(transposed_result[1,], function(x) gsub("[^0-9]","", x)))
new_colname <- gsub(" ", "", paste(array, "Block", transposed_result[2,], sep="-"))
corrected_transposed_result <- transposed_result[c(-1,-2),]
data.table::setnames(corrected_transposed_result, new_colname)
numeric_df <- as.data.frame(lapply(corrected_transposed_result, as.numeric))
numeric_df <- as.data.frame(apply(numeric_df, 2, function(x) round(x, 2)))
rownames(numeric_df) <- rownames(corrected_transposed_result)
} else if (array_type == "huprot") {
long_result <- df[, .(Mvalue = mean(value, na.rm = TRUE)), by = .(array, Name)]
wide_result <- long_result %>% pivot_wider(names_from = Name, values_from = Mvalue)
message("Data calculated/arranged for huprot arrays")
transposed_result <- as.data.frame(t(wide_result))
array <- paste(sep="", "Arr",sapply(transposed_result[1,], function(x) gsub("[^0-9]","", x)))
new_colname <- array
corrected_transposed_result <- transposed_result[-1,]
data.table::setnames(corrected_transposed_result, new_colname)
numeric_df <- as.data.frame(lapply(corrected_transposed_result, as.numeric))
numeric_df <- as.data.frame(apply(numeric_df, 2, function(x) round(x, 2)))
rownames(numeric_df) <- rownames(corrected_transposed_result)
} else {
stop("Please define array type. Supports 'chambered', 'segmented', or 'huprot'")
}
if (nrow(numeric_df) == 0) {
warning("The resulting data frame is empty after processing.")
}
return(numeric_df)
}
df2 <- make.df(df, "chambered")
library(tidy)
library(tidyr)
df2 <- make.df(df, "chambered")
remove.packages("arrayrank")
library(roxygen2)
library(devtools)
roxygenize()
roxygenize()
build()
check()
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
remove.packages("arrayrank")
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
install.packages(c("cli", "rlang"))
install.packages(c("cli", "rlang"))
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
library(arrayrank)
files <- read.gpr()
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
View(df2)
View(df)
View(bg)
View(df)
View(df2)
df3 <- multinorm(df2, method= "protein", protein = 447)
View(df3)
remove.packages("arrayrank")
remove.packages("arrayrank")
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
detach("package:arrayrank", unload = TRUE)
remove.packages("arrayrank")
remove.packages("arrayrank")
detach("package:arrayrank", unload = TRUE)
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
install.packages(c("cli", "rlang"))
remove.packages("arrayrank")
detach("package:arrayrank", unload = TRUE)
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
library(arrayrank)
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
df3 <- multinorm(df2, method= "protein", protein = 447)
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
df3 <- multinorm(df2, method= "protein", protein = 447)
remove.packages("arrayrank")
detach("package:arrayrank", unload = TRUE)
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
library(roxygen2)
library(devtools)
roxygenize()
build()
check()
remove.packages("arrayrank")
detach("package:arrayrank", unload = TRUE)
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
library(arrayrank)
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
df3 <- multinorm(df2, method= "protein", protein = 447)
View(df3)
library(arrayrank)
library(readxl)
data <- readxl::read_xlsx(choose.files())
View(data)
proteins <- detect.hits(data, controls = "BD", examine = "SLE")
View(proteins)
View(proteins)
proteins <- detect.hits(data, controls = "BD", examine = "SLE", sdmean = 0.5,
fold_threshold = 10, absolute_threshold = 5000)
View(proteins)
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
df3 <- arrayrank::replace.low(df2, offset = 10)
df4 <- multinorm(df3, method= "protein", protein = 447)
df5 <- store.df(df4)
View(df5)
files <- read.gpr()
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
df3 <- arrayrank::replace.low(df2, offset = 10)
df4 <- multinorm(df3, method= "protein", protein = 447)
df5 <- store.df(df4)
writexl::write_xlsx(df5, "HedvigCA.xlsx")
files <- read.gpr()
files <- read.gpr()
files <- read.gpr()
files <- read.gpr()
files <- read.gpr()
files <- read.gpr()
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
View(df2)
BDs <- read_xlsx(choose.files())
View(BDs)
View(df2)
fulldf <- cbind(BDs, df2)
View(fulldf)
fulldf <- fulldf[,-1]
View(fulldf)
df3 <- arrayrank::replace.low(fulldf, offset = 10)
df4 <- multinorm(df3, method= "protein", protein = 447)
df5 <- store.df(df4)
writexl::write_xlsx(df5, "HedvigandBenj_CA.xlsx")
data <- readxl::read_xlsx(choose.files())
View(data)
proteins <- detect.hits(data, controls = "BD", examine = "SLE", sdmean = 0.5,
fold_threshold = 10, absolute_threshold = 5000)
View(proteins)
View(data)
proteins <- detect.hits(data, controls = "BD", examine = "SLE", sdmean = 0.1,
fold_threshold = 10, absolute_threshold = 5000)
proteins <- detect.hits(data, controls = "BD", examine = "SLE", sdmean = 0.1,
fold_threshold = 1, absolute_threshold = 5000)
View(proteins)
View(data)
fulldf <- cbind(BDs, df2)
fulldf <- fulldf[,-1]
df3 <- arrayrank::replace.low(fulldf, offset = 10)
df5 <- store.df(df3)
writexl::write_xlsx(df5, "non-norm.xlsx")
data <- readxl::read_xlsx(choose.files())
proteins <- detect.hits(data, controls = "BD", examine = "SLE", sdmean = 0.1,
fold_threshold = 1, absolute_threshold = 5000)
View(proteins)
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "chambered")
df3 <- arrayrank::replace.low(fulldf, offset = 10)
df3 <- arrayrank::replace.low(df2, offset = 10)
df4 <- store.df(df3, "non.xlsx")
df4 <- store.df(df3)
writexl::write_xlsx(df4, "non.xlsx")
View(df4)
df4 <- multinorm(df3, method= "protein", protein = 447)
df5 <- store.df(df4)
writexl::write_xlsx(df5, "normed.xlsx")
data <- readxl::read_xlsx(choose.files())
non-normed_proteins <- detect.hits(data, controls = "control", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 10000)
notnormed_proteins <- detect.hits(data, controls = "control", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 10000)
View(notnormed_proteins)
data <- readxl::read_xlsx(choose.files())
normed_proteins <- detect.hits(data, controls = "control", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 10000)
View(normed_proteins)
normed_proteins <- detect.hits(data, controls = "DM", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 10000)
View(normed_proteins)
data <- readxl::read_xlsx(choose.files())
normed_proteins <- detect.hits(data, controls = "DM", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 10000)
View(normed_proteins)
df4 <- multinorm(df3, method= "quantile")
df5 <- store.df(df4)
writexl::write_xlsx(df5, "normed.xlsx")
data <- readxl::read_xlsx(choose.files())
non_proteins <- detect.hits(data, controls = "DM", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 5000)
data <- readxl::read_xlsx(choose.files())
normed_proteins <- detect.hits(data, controls = "DM", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 5000)
View(normed_proteins)
View(non_proteins)
View(normed_proteins)
View(normed_proteins)
View(non_proteins)
files <- read.gpr()
library(arrayrank)
files <- read.gpr()
files <- read.gpr()
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "huprot")
df3 <- arrayrank::replace.low(df2, offset = 10)
df4 <- store.df(df3)
writexl::write_xlsx(df4, "non.xlsx")
df4 <- multinorm(df3, method= "quantile")
df5 <- store.df(df4)
writexl::write_xlsx(df5, "normed.xlsx")
data <- readxl::read_xlsx(choose.files())
View(data)
normed_proteins <- detect.hits(data, controls = "DM", examine = "PNP", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 5000)
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "huprot")
df3 <- arrayrank::replace.low(df2, offset = 10)
df4 <- store.df(df3)
writexl::write_xlsx(df4, "non.xlsx")
df4 <- multinorm(df3, method= "quantile")
df5 <- store.df(df4)
writexl::write_xlsx(df5, "normed.xlsx")
View(df3)
View(bg)
View(bg[["genes"]])
var_normed <- multinorm(df3, method = "protein", protein = 2888)
View(df3)
if{
which(rownames(df3) == "Anti-human IgG 100ng/u")
View(df3)
which(rownames(df3) == "Anti-human IgG 100ng/ul")
var_normed <- multinorm(df3, method = "protein", protein = 1204)
var_normed <- store.df(var_normed)
writexl::write_xlsx(var_normed, "var_normed.xlsx")
data <- readxl::read_xlsx(choose.files())
normed_proteins <- detect.hits(data, controls = "BD", examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 5000)
normed_proteins <- detect.hits(data, controls = "BD", examine = "SSc", sdmean = 0.9,
fold_threshold = 15, absolute_threshold = 8000)
normed_proteins <- detect.hits(data, controls = "BD", examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
non_result <- detect.hits(data, controls = "BD", examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
data <- readxl::read_xlsx(choose.files())
q_result <- detect.hits(data, controls = "BD", examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
data <- readxl::read_xlsx(choose.files())
var_result <- detect.hits(data, controls = "BD", examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
View(non_result)
View(q_result)
View(non_result)
View(q_result)
View(var_result)
View(q_result)
View(var_result)
View(q_result)
View(non_result)
View(q_result)
View(non_result)
View(q_result)
View(var_result)
View(q_result)
View(var_result)
View(q_result)
View(var_result)
View(df5)
View(df5)
library(arrayrank)
library(arrayrank)
files <- read.gpr()
files <- read.gpr()
bg <- subtract.bg(files)
df <- extraction(bg)
df2 <- make.df(df, "huprot")
df3 <- arrayrank::replace.low(df2, offset = 10)
df4 <- store.df(df3)
writexl::write_xlsx(df4, "non.xlsx")
df4 <- multinorm(df3, method= "quantile")
df5 <- store.df(df4)
writexl::write_xlsx(df5, "normed.xlsx")
which(rownames(df3) == "Anti-human IgG 100ng/ul")
var_normed <- multinorm(df3, method = "protein", protein = 1204)
var_normed <- store.df(var_normed)
writexl::write_xlsx(var_normed, "var_normed.xlsx")
groups <- read_xlsx(choose.files())
library(readxl)
data <- readxl::read_xlsx(choose.files())
groups <- read_xlsx(choose.files())
View(groups)
groups <- groups[1,]
View(groups)
var_result <- detect.hits(data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
groups <- groups[1,-1]
var_result <- detect.hits(data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
View(groups)
groups <- read_xlsx(choose.files())
groups <- groups[1,-1]
var_result <- detect.hits(data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
View(groups)
View(var_normed)
groups <- read_xlsx(choose.files())
groups <- groups[1,-1]
var_result <- detect.hits(data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
data <- readxl::read_xlsx(choose.files())
q_result <- detect.hits(data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
View(q_result)
data <- readxl::read_xlsx(choose.files())
var_result <- detect.hits(data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.9,
fold_threshold = 10, absolute_threshold = 8000)
var_result <- detect.hits(data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.9,
fold_threshold = 20, absolute_threshold = 15000)
View(var_result)
files <- read.gpr()
bg_subbed <- subtract.bg(files)
long_format <- extraction(bg_subbed)
orig_df <- make.df(long_format, "huprot")
df <- replace.low(orig_df, offset = 10)
dfs <- store.df(df)
writexl::write_xlsx(dfs, "non.xlsx")
df_qnorm <- multinorm(df, method= "quantile")
df_qstore <- store.df(df_qnorm)
writexl::write_xlsx(df_qstore, "normed.xlsx")
which(rownames(df) == "Anti-human IgG 100ng/ul")
df_vnorm <- multinorm(df, method = "protein", protein = 1204)
df_vstore <- store.df(df_vnorm)
writexl::write_xlsx(df_vstore, "var_normed.xlsx")
library(readxl)
base_data <- readxl::read_xlsx(choose.files())
q_data <- readxl::read_xlsx(choose.files())
v_data <- readxl::read_xlsx(choose.files())
groups <- read_xlsx(choose.files())
groups <- groups[1,-1]
base_result <- detect.hits(base_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
q_result <- detect.hits(q_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
v_result <- detect.hits(v_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
which(rownames(df) == "Anti-human IgG 1.5625ng/ul")
df_vnorm <- multinorm(df, method = "protein", protein = 1198)
df_vstore <- store.df(df_vnorm)
writexl::write_xlsx(df_vstore, "var_normed.xlsx")
v_data <- readxl::read_xlsx(choose.files())
v_result <- detect.hits(v_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
View(v_result)
which(rownames(df) == "Anti-human IgG 25ng/ul")
which(rownames(df) == "Anti-human IgG 10ng/ul")
which(rownames(df) == "Anti-human IgG 5ng/ul")
which(rownames(df) == "Anti-human IgG 50ng/ul")
which(rownames(df) == "Anti-human IgG 25ng/ul")
df_vnorm <- multinorm(df, method = "protein", protein = 1202)
df_vstore <- store.df(df_vnorm)
writexl::write_xlsx(df_vstore, "var_normed.xlsx")
v_data <- readxl::read_xlsx(choose.files())
v_result <- detect.hits(v_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
which(rownames(df) == "Anti-human IgG 1.5625ng/ul")
df_vnorm <- multinorm(df, method = "protein", protein = 1198)
df_vstore <- store.df(df_vnorm)
writexl::write_xlsx(df_vstore, "var_normed.xlsx")
v_data <- readxl::read_xlsx(choose.files())
v_result <- detect.hits(v_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
files <- read.gpr()
bg_subbed <- subtract.bg(files)
long_format <- extraction(bg_subbed)
orig_df <- make.df(long_format, "huprot")
df <- replace.low(orig_df, offset = 10)
dfs <- store.df(df)
writexl::write_xlsx(dfs, "non.xlsx")
df_qnorm <- multinorm(df, method= "quantile")
df_qstore <- store.df(df_qnorm)
writexl::write_xlsx(df_qstore, "normed.xlsx")
which(rownames(df) == "Anti-human IgG 1.5625ng/ul")
df_vnorm <- multinorm(df, method = "protein", protein = 1198)
df_vstore <- store.df(df_vnorm)
writexl::write_xlsx(df_vstore, "var_normed.xlsx")
library(readxl)
base_data <- readxl::read_xlsx(choose.files())
q_data <- readxl::read_xlsx(choose.files())
v_data <- readxl::read_xlsx(choose.files())
groups <- read_xlsx(choose.files())
groups <- groups[1,-1]
base_result <- detect.hits(base_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
q_result <- detect.hits(q_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
v_result <- detect.hits(v_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
View(base_result)
View(q_result)
View(v_result)
View(dfs)
q_result <- detect.hits(q_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 50, absolute_threshold = 8000)
View(q_result)
files <- read.gpr()
bg_subbed <- subtract.bg(files)
long_format <- extraction(bg_subbed)
orig_df <- make.df(long_format, "huprot")
df <- replace.low(orig_df, offset = 10)
dfs <- store.df(df)
writexl::write_xlsx(dfs, "non.xlsx")
df_qnorm <- multinorm(df, method= "quantile")
df_qstore <- store.df(df_qnorm)
writexl::write_xlsx(df_qstore, "normed.xlsx")
which(rownames(df) == "Anti-human IgG 1.5625ng/ul")
df_vnorm <- multinorm(df, method = "protein", protein = 1198)
df_vstore <- store.df(df_vnorm)
writexl::write_xlsx(df_vstore, "var_normed.xlsx")
q_data <- readxl::read_xlsx(choose.files())
groups <- read_xlsx(choose.files())
groups <- groups[1,-1]
q_result <- detect.hits(q_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 50, absolute_threshold = 8000)
q_result <- detect.hits(q_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
View(q_result)
remove.packages("arrayrank")
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
library(arrayrank)
files <- read.gpr()
devtools::install_github("DrAhmetYalcinkaya/arrayrank")
BiocManager::install("cluster")
install.packages("ropls")
library(arrayrank)
files <- read.gpr()
bg_subbed <- subtract.bg(files)
long_format <- extraction(bg_subbed)
orig_df <- make.df(long_format, "huprot")
df <- replace.low(orig_df, offset = 10)
dfs <- store.df(df)
df_qnorm <- multinorm(df, method= "quantile")
df_qstore <- store.df(df_qnorm)
writexl::write_xlsx(df_qstore, "normed.xlsx")
library(readxl)
q_data <- readxl::read_xlsx(choose.files())
q_data <- readxl::read_xlsx(choose.files())
groups <- read_xlsx(choose.files())
View(q_data)
View(orig_df)
View(q_data)
View(orig_df)
q_data <- readxl::read_xlsx(choose.files())
View(groups)
groups <- groups[1,-1]
View(groups)
q_result <- detect.hits(q_data, controls = "BD", group_vector = groups, examine = "SSc", sdmean = 0.7,
fold_threshold = 10, absolute_threshold = 8000)
View(q_result)
library(arrayrank)
library(readxl)
files <- read.gpr()
bg_subbed <- subtract.bg(files)
long_format <- extraction(bg_subbed)
orig_df <- make.df(long_format, "chambered")
df <- replace.low(orig_df, offset = 10)
df_qnorm <- multinorm(df, method= "quantile")
df_qstore <- store.df(df_qnorm)
writexl::write_xlsx(df_qstore, "protSgroup.xlsx")
orig_df <- make.df(long_format, "chambered")
df <- replace.low(orig_df, offset = 10)
View(df)
files <- read.gpr()
bg_subbed <- subtract.bg(files)
long_format <- extraction(bg_subbed)
orig_df <- make.df(long_format, "chambered")
df <- replace.low(orig_df, offset = 10)
df_qnorm <- multinorm(df, method= "quantile")
df_qstore <- store.df(df_qnorm)
writexl::write_xlsx(df_qstore, "protSgroup.xlsx")
